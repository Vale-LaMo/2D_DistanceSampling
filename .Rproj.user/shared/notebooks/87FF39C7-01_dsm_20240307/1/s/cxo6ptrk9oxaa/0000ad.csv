"0","## ---- prediction and plot Nhat and uncertainty ----"
"0","prediction.Nhat <- unlist(dsm.var.subset$pred)"
"0","prediction.CV <- sqrt(dsm.var.subset$pred.var)/unlist(dsm.var.subset$pred)"
"0","prediction.stdev <- sqrt(dsm.var.subset$pred.var)"
"0","pp <- mutate(as.data.frame(preddata), Nhat = prediction.Nhat)"
"0","pp.uncertainty <- mutate(pp, CV = prediction.CV, stdev = prediction.stdev)"
"0","# plot Nhat"
"0",""
"0","# pNhat <- ggplot(pp) +"
"0","#   geom_tile(aes(x=x, y=y, fill=Nhat, "
"0","#                 width=1/params$conversion_km_m, "
"0","#                 height=1/params$conversion_km_m)) +"
"0","#   scale_fill_distiller(palette = ""YlGn"", direction=2,"
"0","#                        breaks = seq(min(pp$Nhat),max(pp$Nhat), length.out = 4),"
"0","#                        labels = round((seq(min(pp$Nhat),"
"0","#                                            max(pp$Nhat),"
"0","#                                            length.out = 4)/(preddata$area[1]/1000000)),0))+"
"0","#   #                      values = c(seq(0, 60, 60))) +"
"0","#   # scale_fill_distiller(palette = ""YlGn"", direction=2, trans = ""log10"", "
"0","#   #                      name = ""log10(Similarity)"") +"
"0","#   labs(fill=""Nhat"") +"
"0","#   theme_minimal() +"
"0","#   coord_equal()"
"0","# print(pNhat)"
"0",""
"0","pNhat <- ggplot(pp) +"
"0","  geom_tile(aes(x=x, y=y, fill=Nhat/(preddata$area[1]/1000000), "
"0","                width=1/params$conversion_km_m, "
"0","                height=1/params$conversion_km_m)) +"
"0","  scale_fill_distiller(palette = ""YlGn"", direction=2) +"
"0","  #                      values = c(seq(0, 60, 60))) +"
"0","  # scale_fill_distiller(palette = ""YlGn"", direction=2, trans = ""log10"", "
"0","  #                      name = ""log10(Similarity)"") +"
"0","  labs(fill=""Nhat"") +"
"0","  theme_minimal() +"
"0","  coord_equal()"
"0","print(pNhat)"
